# Репозиторий для домашних работ по курсу "Разработчик на Spring Framework"

Группа 2025-03

#### Студент:

Вараксин Александр

---

<a name="content"></a>
### Содержание

- [HW-01. XML-config.](#hw01)
- [HW-02. Annotation-config.](#hw02)
- [HW-03. Spring-boot.](#hw03)
- [HW-04. Spring-shell.](#hw04)
- [HW-05. Spring-jdbc.](#hw05)
- [HW-06. Spring-ORM-JPA-Hibernate.](#hw06)
- [HW-07. Spring Data JPA.](#hw07)
- [HW-08. Spring Data MongoDB.](#hw08)
- [HW-09. Spring MVC Thymeleaf.](#hw09)

---

<a name="hw01"></a>

### HW-01. XML-config.

Создан GitHub-репозиторий для выполнения домашних заданий.
Все зависимости настроены в IoC контейнере.
Контекст описывается XML-файлом.
Список вопросов с вариантами ответа хранится в ресурсах приложения, в формате csv.
Для проверки работоспособности сервиса тестирования написан юнит-тест.

<br/>

[[вернуться к содержанию]](#content)

---

<a name="hw02"></a>

### HW-02. Annotation-config.

Контекст описан с помощью Java-based и Annotation-based конфигурации.
Имя ресурса (файла в формате csv) с вопросами, а также количество правильных ответов для прохождения теста конфигурируются через файл настроек application.properties.
Приложение запрашивает фамилию и имя студента, задает вопросы с вариантами ответа и выводит результат тестирования студента.

<br/>

[[вернуться к содержанию]](#content)

---

<a name="hw03"></a>

### HW-03. Spring-boot.

Загрузка конфигурации и настройка приложения выполняется с применением аннотаций Spring Boot.
Локаль, имя ресурса (файла в формате csv) с вопросами, а также количество правильных ответов для прохождения теста конфигурируются через файл настроек application.yml.
Локализация выводимых сообщений настроена через свойства файлов message.properties для английского языка и messages_ru_RU.properties для русского языка.
В приложении применяется авторский баннер.
Приложение запрашивает фамилию и имя студента, задает вопросы с вариантами ответа и выводит результат тестирования студента на английском или русском языке в зависимости от выбранной настройки локали.

<br/>

[[вернуться к содержанию]](#content)

---

<a name="hw04"></a>

### HW-04. Spring-shell.

Расширена функциональность приложения. Управление запуском приложения осуществляется через Spring Shell команды.
Для запуска процесса тестирования необходимо использовать одну из команд "r", "run", "s" или "start", для завершения процесса тестирования необходимо использовать команду "exit".
Тестовые классы адартированы для тестирования с частичной загрузкой контекста с помощью аннотации @SpringBootTest и соответствующих атрибутов.

<br/>

[[вернуться к содержанию]](#content)

---

<a name="hw05"></a>

### HW-05. Spring-jdbc.

Разработано однопользовательское, консольное приложение позволяющее вести каталог книг в библиотеке.
В приложении используются Spring JDBC и реляционная база данных H2.
Параметризованные запросы выполняются с помощью NamedParametersJdbcTemplate.
Создание и инициализация схемы БД выполняются через schema.sql + data.sql.
С помощью @JdbcTest разработаны интеграционные тесты всех методов DAO Author, Genre, Book.
Управление в консоли приложения осуществляется через Spring Shell команды.
#### Наименование и назначение команд Spring Shell для работы с авторами, жанрами и книгами:
- "aa" : "Find all authors".
	Example : "aa".
	Result : "Id: 1, FullName: Author_1,
			  Id: 2, FullName: Author_2,
			  Id: 3, FullName: Author_3".
- "ab" : "Find all books".
	Example : "ab".
	Result : "Id: 1, title: BookTitle_1, author: {Id: 1, FullName: Author_1}, genres: [Id: 1, Name: Genre_1],
			  Id: 2, title: BookTitle_2, author: {Id: 2, FullName: Author_2}, genres: [Id: 2, Name: Genre_2],
			  Id: 3, title: BookTitle_3, author: {Id: 3, FullName: Author_3}, genres: [Id: 3, Name: Genre_3]".
- "ag" : "Find all genres".
	Example : "ag".
	Result : "Id: 1, Name: Genre_1,
			  Id: 2, Name: Genre_2,
			  Id: 3, Name: Genre_3".
- "bbid" : "Find book by id".
	Example : "bbid 2".
	Result : "Id: 2, title: BookTitle_2, author: {Id: 2, FullName: Author_2}, genres: [Id: 2, Name: Genre_2]".
- "bins" : "Insert book".
	Example : "bins Dracula 2 1".
	Result : "Id: 4, title: Dracula, author: {Id: 2, FullName: Author_2}, genres: [Id: 1, Name: Genre_1]".
- "bdel" : "Delete book by id".
	Example : "bdel 4".
	Result : "".
- "bupd" : "Update book".
	Example : "bupd 4 Pollyanna 1 1".
	Result : "Id: 4, title: Pollyanna, author: {Id: 1, FullName: Author_1}, genres: [Id: 1, Name: Genre_1]".

<br/>

[[вернуться к содержанию]](#content)

---
<a name="hw06"></a>

### HW-06. Spring-ORM-JPA-Hibernate.

Приложение каталога книг переведено на использование Spring ORM, JPA и Hibernate (EntityManager).
Дополнена доменная модель сущностью комментария к книге (один-ко-многим).

#### Основные изменения:
- Реализованы JPA-репозитории для всех сущностей (Author, Book, Genre, Comment)
- Добавлена сущность Comment с отношением @ManyToOne к Book
- Реализованы CRUD операции для комментариев:
  - Поиск комментария по id
  - Поиск всех комментариев по id книги
  - Создание, обновление и удаление комментариев
- Оптимизированы запросы для избежания проблем N+1:
  - Использованы JOIN FETCH в запросах
  - Lazy-инициализация для связей
- Аннотация @Transactional перенесена на уровень сервисов
- Написаны интеграционные тесты для всех репозиториев с использованием @DataJpaTest и TestEntityManager
- Добавлены тесты сервисов, проверяющие отсутствие LazyInitializationException
- DDL через Hibernate отключено, используется schema.sql

#### Наименование и назначение команд Spring Shell для работы с комментариями:
- "cbbid" : "Find all comments by book id".
	Example: "cbbid 1".
	Result: "Id: 1, Text: Comment_1, BookId: 1, Id: 2, Text: Comment_2, BookId: 1".
- "cbid" : "Find comment by id".
	Example: "cbid 1".
	Result: "Id: 1, Text: Comment_1, BookId: 1".
- "csave" : "Save comment (create or update)".
	Example: "csave 1 New comment text".
	Result: "Id: 4, Text: New comment text, BookId: 1".
- "cdel" : "Delete comment by id".
	Example: "cdel 4".
	Result: "".

<br/>

[[вернуться к содержанию]](#content)

---

<a name="hw07"></a>

### HW-07. Spring Data JPA.
Приложение каталога книг переведено на использование Spring Data JPA репозиториев.
Сохранена вся функциональность предыдущей версии (HW-06)с оптимизацией кода через использование встроенных возможностей Spring Data.

#### Основные изменения и сохраненные подходы к реализации на базе HW-06:
- Все репозитории (AuthorRepository, BookRepository, GenreRepository, CommentRepository) переписаны на Spring Data JPA и теперь расширяют интерфейс JpaRepository
- Кастомные запросы реализованы через @Query с использованием JPQL
- Использованы встроенные методы Spring Data (findAll, findById, save, deleteById)
- Сохранена оптимизация запросов для избежания проблем N+1: кастомные JPQL-запросы с JOIN FETCH для сложных выборок
- Сохранена корректная реализация equals/hashCode/toString в сущностях
- Аннотация @Transactional осталась на уровне сервисов
- Все интеграционные тесты с HW-06 адаптированы под Spring Data JPA:
- Тесты используют @DataJpaTest и @TestEntityManager
- Проверяется отсутствие LazyInitializationException
- Сохранена проверка всех CRUD операций
- DDL через Hibernate остается отключенным, используется schema.sql

#### Сохраненная функциональность Spring Shell:
Все команды из HW-06 остаются полностью рабочими:
- Работа с авторами: aa
- Работа с жанрами: ag
- Работа с книгами: ab, bbid, bins, bdel, bupd
- Работа с комментариями: cbbid, cbid, csave, cdel

#### Преимущества реализации:
- Значительное сокращение boilerplate кода в репозиториях
- Использование встроенных методов Spring Data уменьшает вероятность ошибок
- Стандартизированный подход к работе с данными
- Упрощенная поддержка и расширение функциональности

<br/>

[[вернуться к содержанию]](#content)

---

<a name="hw08"></a>

### HW-08. Spring Data MongoDB.

Приложение каталога книг переведено на использование Spring Data MongoDB репозиториев и MongoDB для хранения данных. Реализация выполнена на базе предыдущей работы (HW-07) с полным удалением следов реляционных технологий доступа к данным.

#### Основные изменения и особенности реализации:

**Архитектурные изменения:**
- Подключена зависимость `spring-boot-starter-data-mongodb`
- Полностью удалены все следы JPA/Hibernate/JDBC технологий
- Все репозитории переписаны на Spring Data MongoDB интерфейсы (`MongoRepository`)
- Доменные сущности адаптированы под документную модель MongoDB

**Тестирование:**
- Реализовано тестирование с использованием Flapdoodle Embedded MongoDB
- Написаны комплексные интеграционные тесты для всех сервисов
- Удалены все JPA-специфичные тесты
- Тесты проверяют консистентность данных при операциях CRUD

**Сохраненная функциональность Spring Shell:**
Все команды из предыдущих версий остаются полностью рабочими с сохранением семантики:
- Работа с авторами: aa
- Работа с жанрами: ag  
- Работа с книгами: ab, bbid, bins, bdel, bupd
- Работа с комментариями: cbbid, cbid, csave, cdel

#### Преимущества реализации:
- Полное соответствие требованиям документной модели данных
- Отсутствие лишних зависимостей и следов реляционных технологий
- Высокая производительность за счет оптимизированных запросов
- Надежное тестирование на встроенной MongoDB
- Сохранение всей функциональности предыдущих версий

<br/>

[[вернуться к содержанию]](#content)

---

<a name="hw09"></a>

### HW-09. Spring MVC Thymeleaf.
Консольное приложение каталога книг преобразовано в полнофункциональное веб-приложение с использованием Spring MVC и Thymeleaf. Реализация выполнена на базе предыдущей работы (Spring Data JPA) с полным удалением Spring Shell и переходом на веб-интерфейс.

#### Основные изменения и особенности реализации:
**Архитектурные изменения:**
- Удалены все Spring Shell команды и зависимости
- Реализованы классические MVC контроллеры (@Controller) для всех сущностей
- Добавлены Thymeleaf шаблоны для всех страниц приложения
- Настроена навигация между страницами

**Реализованные CRUD операции:**
- Книги: просмотр списка, создание, редактирование, удаление, просмотр детальной информации
- Авторы: просмотр списка авторов
- Жанры: просмотр списка жанров
- Комментарии: создание, удаление, просмотр комментариев к книге

**Структура веб-интерфейса:**
- Главная страница (/) - список всех книг
- Страница создания книги (/books/create) - форма с выбором автора и жанра из выпадающих списков
- Страница редактирования книги (/books/edit/{id}) - форма с предзаполненными данными
- Страница просмотра книги (/books/{id}) - детальная информация о книге со списком комментариев
- Страницы списков авторов (/authors) и жанров (/genres)
- Страницы подтверждения удаления книг и комментариев

**Тестирование:**
- Реализованы комплексные тесты для BookController с использованием @WebMvcTest
- Протестированы все CRUD endpoints с мокированием сервисов
- Проверены сценарии успешного выполнения операций и обработки ошибок
- Протестирована валидация параметров и редиректы

#### Особенности реализации:
- Для выбора авторов и жанров используются HTML <select> элементы с предзагруженными списками
- Удаление сущностей выполняется только через HTTP POST метод
- Реализована единая навигация с возможностью возврата на главную страницу из любого места
- Добавлена обработка исключений через @ControllerAdvice для EntityNotFoundException

#### Преимущества реализации:
- Полнофункциональный веб-интерфейс вместо консольного приложения
- Сохранение всей бизнес-логики предыдущих версий
- Корректная обработка ошибок и исключительных ситуаций
- Полное покрытие тестами контроллера для работы с книгами
- Удобная навигация и пользовательский интерфейс
- Соответствие RESTful принципам работы с HTTP методами

<br/>

[[вернуться к содержанию]](#content)

---